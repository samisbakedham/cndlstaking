!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Portis=t():e.Portis=t()}(this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ERR_NOT_IN_IFRAME=t.ERR_CONNECTION_TIMEOUT=t.ERR_CONNECTION_DESTROYED=void 0;t.ERR_CONNECTION_DESTROYED="ConnectionDestroyed";t.ERR_CONNECTION_TIMEOUT="ConnectionTimeout";t.ERR_NOT_IN_IFRAME="NotInIframe";var o,r={"http:":"80","https:":"443"},i=/^(https?:)?\/\/([^/:]+)(:(\d+))?/,a={ERR_CONNECTION_DESTROYED:"ConnectionDestroyed",ERR_CONNECTION_TIMEOUT:"ConnectionTimeout",ERR_NOT_IN_IFRAME:"NotInIframe",Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},c=(o=0,function(){return++o}),s=function(){if(a.debug){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=console).log.apply(e,["[Penpal]"].concat(n))}},d=function(e){var t=[];return e(function(){t.forEach(function(e){e()})}),{then:function(e){t.push(e)}}},u=function(e){return{name:e.name,message:e.message,stack:e.stack}},l=function(e,t,n,o){var r=t.localName,i=t.local,d=t.remote,u=t.remoteOrigin,l=!1;s("".concat(r,": Connecting call sender"));var f=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(s("".concat(r,": Sending ").concat(e,"() call")),l){var f=new Error("Unable to send ".concat(e,"() call due ")+"to destroyed connection");throw f.code="ConnectionDestroyed",f}return new a.Promise(function(t,o){var a=c();i.addEventListener("message",function n(c){if(c.source===d&&c.origin===u&&"reply"===c.data.penpal&&c.data.id===a){s("".concat(r,": Received ").concat(e,"() reply")),i.removeEventListener("message",n);var l=c.data.returnValue;c.data.returnValueIsError&&(f=l,p=new Error,Object.keys(f).forEach(function(e){return p[e]=f[e]}),l=p),("fulfilled"===c.data.resolution?t:o)(l)}var f,p}),d.postMessage({penpal:"call",id:a,methodName:e,args:n},u)})}};o.then(function(){l=!0}),n.reduce(function(e,t){return e[t]=f(t),e},e)},f=function(e,t,n){var o=e.localName,r=e.local,i=e.remote,c=e.remoteOrigin,d=!1;s("".concat(o,": Connecting call receiver"));var l=function(e){if(e.source===i&&e.origin===c&&"call"===e.data.penpal){var n=e.data,r=n.methodName,l=n.args,f=n.id;if(s("".concat(o,": Received ").concat(r,"() call")),r in t){var p=function(e){return function(t){if(s("".concat(o,": Sending ").concat(r,"() reply")),d)s("".concat(o,": Unable to send ").concat(r,"() reply due to destroyed connection"));else{var n={penpal:"reply",id:f,resolution:e,returnValue:t};"rejected"===e&&t instanceof Error&&(n.returnValue=u(t),n.returnValueIsError=!0);try{i.postMessage(n,c)}catch(e){throw"DataCloneError"===e.name&&i.postMessage({penpal:"reply",id:f,resolution:"rejected",returnValue:u(e),returnValueIsError:!0},c),e}}}};new a.Promise(function(e){return e(t[r].apply(t,l))}).then(p("fulfilled"),p("rejected"))}}};r.addEventListener("message",l),n.then(function(){d=!0,r.removeEventListener("message",l)})};a.connectToChild=function(e){var t,n=e.url,o=e.appendTo,c=e.methods,u=void 0===c?{}:c,p=e.timeout,h=new d(function(e){t=e}),m=window,g=document.createElement("iframe");(o||document.body).appendChild(g),h.then(function(){g.parentNode&&g.parentNode.removeChild(g)});var v=g.contentWindow||g.contentDocument.parentWindow,w=function(e){var t,n,o,a=document.location,c=i.exec(e);c?(t=c[1]?c[1]:a.protocol,n=c[2],o=c[4]):(t=a.protocol,n=a.hostname,o=a.port);var s=o&&o!==r[t]?":".concat(o):"";return"".concat(t,"//").concat(n).concat(s)}(n);return{promise:new a.Promise(function(e,o){var r;void 0!==p&&(r=setTimeout(function(){var e=new Error("Connection to child timed out after ".concat(p,"ms"));e.code="ConnectionTimeout",o(e),t()},p));var i,a,c={},y=function(t){if(t.source===v&&t.origin===w&&"handshake"===t.data.penpal){s("Parent: Received handshake, sending reply"),t.source.postMessage({penpal:"handshake-reply",methodNames:Object.keys(u)},t.origin);var n={localName:"Parent",local:m,remote:v,remoteOrigin:t.origin};a&&a();var o=new d(function(e){h.then(e),a=e});f(n,u,o),i&&i.forEach(function(e){delete c[e]}),i=t.data.methodNames,l(c,n,i,h),clearTimeout(r),e(c)}};m.addEventListener("message",y),h.then(function(){m.removeEventListener("message",y);var e=new Error("Connection destroyed");e.code="ConnectionDestroyed",o(e)}),s("Parent: Loading iframe"),g.src=n}),iframe:g,destroy:t}},a.connectToParent=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.parentOrigin,o=void 0===n?"*":n,r=t.methods,i=void 0===r?{}:r,c=t.timeout;if(window===window.top){var u=new Error("connectToParent() must be called within an iframe");throw u.code="NotInIframe",u}var p=new d(function(t){e=t}),h=window,m=h.parent;return{promise:new a.Promise(function(t,n){var r;void 0!==c&&(r=setTimeout(function(){var t=new Error("Connection to parent timed out after ".concat(c,"ms"));t.code="ConnectionTimeout",n(t),e()},c));var a=function e(n){if(("*"===o||o===n.origin)&&n.source===m&&"handshake-reply"===n.data.penpal){s("Child: Received handshake reply"),h.removeEventListener("message",e);var a={localName:"Child",local:h,remote:m,remoteOrigin:n.origin},c={};f(a,i,p),l(c,a,n.data.methodNames,p),clearTimeout(r),t(c)}};h.addEventListener("message",a),p.then(function(){h.removeEventListener("message",a);var e=new Error("Connection destroyed");e.code="ConnectionDestroyed",n(e)}),s("Child: Sending handshake"),m.postMessage({penpal:"handshake",methodNames:Object.keys(i)},o)}),destroy:e}};var p=a;t.default=p},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o);function i(e,t){var n="string"==typeof e?Object.assign({},a[e]):e;if("object"!=typeof n)throw new Error("[Portis] illegal 'network' parameter. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(!n.nodeUrl)throw new Error("[Portis] 'nodeUrl' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(t&&!n.gasRelayHubAddress)throw new Error("[Portis] can't find default gas relay hub for "+e);return"string"!=typeof e||t||delete n.gasRelayHubAddress,n.nodeProtocol=n.nodeProtocol||"rpc",n}var a={eos:{nodeUrl:"https://api.eosdetroit.io",nodeProtocol:"rpc",chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906"},eosJungle:{nodeUrl:"https://jungle2.cryptolions.io",nodeProtocol:"rpc",chainId:"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473"}},c=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,c)}s((o=o.apply(e,t||[])).next())})},s=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},d="1.0.0-beta.3",u="https://widget-eos.portis.io",l=function(){function e(e,t,n){void 0===n&&(n={}),this._widgetUrl=u,function(){var e="localhost"===location.hostname||"127.0.0.1"===location.hostname,t="https:"===location.protocol;if(!e&&!t)throw"[Portis] Access to the WebCrypto API is restricted to secure origins.\nIf this is a development environment please use http://localhost:"+location.port+" instead.\nOtherwise, please use an SSL certificate."}(),this._valiadateParams(e,t,n),this.config={dappId:e,network:i(t),version:d,scope:n.scope,registerPageByDefault:n.registerPageByDefault},this.widget=this._initWidget()}return e.prototype.showPortis=function(){return c(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.widget];case 1:return[2,e.sent().communication.showPortis(this.config)]}})})},e.prototype.getAccounts=function(){return c(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.widget];case 1:return[2,e.sent().communication.getAccounts(this.config)]}})})},e.prototype.onLogin=function(e){this._onLoginCallback=e},e.prototype._valiadateParams=function(e,t,n){if(!e)throw new Error("[Portis] 'dappId' is required. Get your dappId here: https://dashboard.portis.io");if(!t)throw new Error("[Portis] 'network' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(void 0!==n.registerPageByDefault&&"boolean"!=typeof n.registerPageByDefault)throw new Error("[Portis] invalid 'registerPageByDefault' parameter, must be a boolean. Read more about it here: https://docs.portis.io/#/configuration?id=registerPageByDefault")},e.prototype._initWidget=function(){var e=this;return new Promise(function(t,n){var o=function(){return c(e,void 0,void 0,function(){var e,n,o,i,a;return s(this,function(c){switch(c.label){case 0:return(e=document.createElement("style")).innerHTML="\n.por_portis-container {\n  position: fixed;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  right: 0px;\n  z-index: 2147483647;\n}\n\n@media (max-width: 576px) {\n  .por_portis-container {\n    bottom: 0;\n    top: auto;\n  }\n}\n\n.por_portis-widget-frame {\n  position: fixed;\n  width: 375px;\n  height: 0;\n  top: 20px;\n  right: 20px;\n  box-shadow: 0 5px 40px rgba(0,0,0,.16);\n  border-radius: 8px;\n  overflow: hidden;\n  z-index: 2147483000;\n}\n\n@media (max-width: 576px) {\n  .por_portis-widget-frame {\n    bottom: 0;\n    top: auto;\n    width: 100%;\n    right: 0;\n    left: 0;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n}\n",(n=document.createElement("div")).className="por_portis-container",(o=document.createElement("div")).id="portis-container-"+Date.now(),o.className="por_portis-widget-frame",n.appendChild(o),document.body.appendChild(n),document.head.appendChild(e),(i=r.a.connectToChild({url:this._widgetUrl,appendTo:document.getElementById(o.id),methods:{setHeight:this._setHeight.bind(this),getWindowSize:this._getWindowSize.bind(this),onLogin:this._onLogin.bind(this)}})).iframe.style.position="absolute",i.iframe.style.height="100%",i.iframe.style.width="100%",i.iframe.style.border="0 transparent",[4,i.promise];case 1:return a=c.sent(),t({communication:a,iframe:i.iframe,widgetFrame:o}),[2]}})})};["loaded","interactive","complete"].indexOf(document.readyState)>-1?o():window.addEventListener("load",o.bind(e),!1)})},e.prototype._setHeight=function(e){return c(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.widget];case 1:return t.sent().widgetFrame.style.height=e+"px",[2]}})})},e.prototype._getWindowSize=function(){var e=document.getElementsByTagName("body")[0];return{width:window.innerWidth||document.documentElement.clientWidth||e.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||e.clientHeight}},e.prototype._onLogin=function(e,t,n,o,r){this._onLoginCallback&&this._onLoginCallback(e,t,n,o,r)},e}();t.default=l}]).default});